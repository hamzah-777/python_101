<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Quiz Landing Page</title>
	<!-- Bootstrap CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>

<body>
	<div class="container">
		<h1 class="mt-4">Quiz Landing Page</h1>
		<form id="playerForm" class="mt-3">
			<div class="mb-3">
				<label for="playerName" class="form-label">Enter your name:</label>
				<input type="text" class="form-control" id="playerName" required placeholder="Enter name to start quizz"/>
			</div>
			<button type="submit" class="btn btn-primary">Start Quiz</button>
		</form>

		<br />
		<hr />
		<h2>Player Scorecard</h2>
		<div id="recentPlayersScores" class="mt-3"></div>
	</div>

	<!-- Bootstrap JS and Popper.js -->
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
	<!-- jQuery -->
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</body>
<script>
	$(document).ready(function () {
		// Load player scores and display on the landing page
		loadScores();
		displayPlayerList();

		// Event listener for player form submission
		$("#playerForm").submit(function (event) {
			event.preventDefault();
			const playerName = $("#playerName").val();

			if (!playerName.trim()) {
				alert("Please enter a valid name.");
				return;
			}

			// Save current player and redirect to quiz page
			localStorage.setItem("currentPlayer", playerName.trim().toUpperCase());
			window.location.href = "quiz.html";
		});
	});

	function loadScores() {
		const storedScores = localStorage.getItem("playerScores");

		if (storedScores) {
			allPlayerScores = JSON.parse(storedScores);
		} else {
			allPlayerScores = []; // Initialize as an empty array if not present
		}
	}

	function displayPlayerList() {
		const recentPlayersScores = $("#recentPlayersScores");
		recentPlayersScores.empty();

		// Display recent players' scores in a table
		const table = `<table class="table table-bordered">
                    <thead>
                        <tr>
                            <th scope="col">Player Name</th>
                            <th scope="col">Score</th>
                            <th scope="col">Completion Time</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${Object.entries(allPlayerScores)
				.map(([playerName, player]) => {
					return `<tr>
                                        <td>${playerName}</td>
                                        <td>${player.score}</td>
                                        <td>${new Date(
						player.completionTime
					).toLocaleString()}</td>
                                    </tr>`;
				})
				.join("")}
                    </tbody>
                </table>`;

		recentPlayersScores.append(table);
	}
</script>

</html>